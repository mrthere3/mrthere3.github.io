

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Wang sanmeng">
  <meta name="keywords" content="">
  
    <meta name="description" content="DJANGO 学习 1.安装djangopip install django  2.创建项目django项目中会有一些默认的文件和默认的文件夹 2.1在终端在项目路径下 django-admin startproject projectname  │  manage.py 	[项目的管理，启动项目，创建app，数据管理] │ └─mydj         asgi.py		[接受网络请求]">
<meta property="og:type" content="article">
<meta property="og:title" content="Django学习笔记">
<meta property="og:url" content="https://mrthere3.github.io/2022/10/29/DJANGO%20%E5%AD%A6%E4%B9%A0/index.html">
<meta property="og:site_name" content="王三梦的博客">
<meta property="og:description" content="DJANGO 学习 1.安装djangopip install django  2.创建项目django项目中会有一些默认的文件和默认的文件夹 2.1在终端在项目路径下 django-admin startproject projectname  │  manage.py 	[项目的管理，启动项目，创建app，数据管理] │ └─mydj         asgi.py		[接受网络请求]">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://mrthere3.github.io/pages/%E6%B7%98%E5%AE%9D%E5%BA%97%E9%93%BA%E5%90%8D%E7%B4%A0%E6%9D%90%E5%BD%93%E9%93%BA25.jpg">
<meta property="article:published_time" content="2022-10-29T02:00:00.000Z">
<meta property="article:modified_time" content="2022-11-02T11:51:06.308Z">
<meta property="article:author" content="Wang sanmeng">
<meta property="article:tag" content="DJANGO">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://mrthere3.github.io/pages/%E6%B7%98%E5%AE%9D%E5%BA%97%E9%93%BA%E5%90%8D%E7%B4%A0%E6%9D%90%E5%BD%93%E9%93%BA25.jpg">
  
  
  
  <title>Django学习笔记 - 王三梦的博客</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/prism/1.28.0/plugins/line-numbers/prism-line-numbers.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"mrthere3.github.io","root":"/","version":"1.9.3","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading94.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>wsm&#39;s blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/pages/%E6%B7%98%E5%AE%9D%E5%BA%97%E9%93%BA%E5%90%8D%E7%B4%A0%E6%9D%90%E5%BD%93%E9%93%BA%2019.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="Django学习笔记"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2022-10-29 10:00" pubdate>
          2022年10月29日 上午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          27k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          227 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">Django学习笔记</h1>
            
            
              <div class="markdown-body">
                
                <p><em>DJANGO</em> 学习</p>
<h2 id="1-安装django"><a href="#1-安装django" class="headerlink" title="1.安装django"></a>1.安装django</h2><figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python">pip install django<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></figure>

<h2 id="2-创建项目"><a href="#2-创建项目" class="headerlink" title="2.创建项目"></a>2.创建项目</h2><p>django项目中会有一些默认的文件和默认的文件夹</p>
<h2 id="2-1在终端"><a href="#2-1在终端" class="headerlink" title="2.1在终端"></a>2.1在终端</h2><p>在项目路径下</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">django-admin startproject projectname<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></figure>

<figure><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">│  manage.py 	[项目的管理，启动项目，创建app，数据管理]
│
└─mydj
        asgi.py		[接受网络请求]
        settings.py		[项目配置 ]
        urls.py		[路径函数的对应关系]
        wsgi.py		[接受网络请求]
        __init__.py<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="3-APP"><a href="#3-APP" class="headerlink" title="3.APP"></a>3.APP</h2><figure><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">-项目
	-app,	用户管理【表结构、函数、HTML模板、CSS】
	-app,	订单管理【表结构、函数、HTML模板、CSS】
	-app,	后台管理【表结构、函数、HTML模板、CSS】
	-app,	网站【表结构、函数、HTML模板、CSS】
	-app,	API【表结构、函数、HTML模板、CSS】
	..
	注意 我们开发变焦简介，用不到多app<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<p>创建app</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">python manage.py startapp appname<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></figure>



<figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python">python manage<span class="token punctuation">.</span>py startapp appname
<span class="token comment">#文件结构如下图</span>
│  manage<span class="token punctuation">.</span>py
│
├─app01
│  │  admin<span class="token punctuation">.</span>py 【django默认提供了后台管理】
│  │  apps<span class="token punctuation">.</span>py
│  │  models<span class="token punctuation">.</span>py
│  │  tests<span class="token punctuation">.</span>py	【单元测试文件】
│  │  views<span class="token punctuation">.</span>py	【视图函数】
│  │  __init__<span class="token punctuation">.</span>py
│  │
│  └─migrations
│          __init__<span class="token punctuation">.</span>py
│
└─mydj
    │  asgi<span class="token punctuation">.</span>py
    │  settings<span class="token punctuation">.</span>py
    │  urls<span class="token punctuation">.</span>py
    │  wsgi<span class="token punctuation">.</span>py
    │  __init__<span class="token punctuation">.</span>py
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="4-快速上手"><a href="#4-快速上手" class="headerlink" title="4.快速上手"></a>4.快速上手</h2><h3 id="在setting-py文件当中注册app"><a href="#在setting-py文件当中注册app" class="headerlink" title="在setting.py文件当中注册app"></a>在setting.py文件当中注册app</h3><p><img src="https://cdn.jsdelivr.net/gh/mrthere3/typora_note/img/js/202208051521176.png" srcset="/img/loading94.gif" lazyload></p>
<h3 id="编写url和视图函数关系"><a href="#编写url和视图函数关系" class="headerlink" title="编写url和视图函数关系"></a>编写url和视图函数关系</h3><p><img src="https://cdn.jsdelivr.net/gh/mrthere3/typora_note/img/js/202208051528185.png" srcset="/img/loading94.gif" lazyload></p>
<ol>
<li>路由系统复杂多变，也可以通过include（“app.urls”）,将连接通往子路由系统</li>
<li>re_path()可以帮助我们匹配更加复杂的路由规则包含正则表达式。</li>
</ol>
<h3 id="编写视图函数views-index"><a href="#编写视图函数views-index" class="headerlink" title="编写视图函数views.index"></a>编写视图函数views.index</h3><p><img src="https://cdn.jsdelivr.net/gh/mrthere3/typora_note/img/js/202208051530473.png" srcset="/img/loading94.gif" lazyload></p>
<h3 id="项目启动命令"><a href="#项目启动命令" class="headerlink" title="项目启动命令"></a>项目启动命令</h3><ul>
<li><p>命令行启动</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python">python manage<span class="token punctuation">.</span>py runserver<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></figure></li>
</ul>
<h3 id="模板文件templates目录"><a href="#模板文件templates目录" class="headerlink" title="模板文件templates目录"></a>模板文件templates目录</h3><figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">user_list</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span><span class="token string">"user_list.html"</span><span class="token punctuation">)</span> <span class="token comment">#在app目录下的templates目录下寻找该HTML文件</span>
<span class="token comment">#优先在templates目录下寻找</span>
<span class="token comment">#根据app的注册顺序，在每个app下的templates目录中去寻找</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<p><img src="https://cdn.jsdelivr.net/gh/mrthere3/typora_note/img/js/202208051602276.png" srcset="/img/loading94.gif" lazyload></p>
<h3 id="静态文件路径static目录下"><a href="#静态文件路径static目录下" class="headerlink" title="静态文件路径static目录下"></a>静态文件路径static目录下</h3><ul>
<li>CSS</li>
<li>图片</li>
<li>JS</li>
</ul>
<p>默认存放在static目录下，在进行调用时候，进行&#x2F;static加完整路径进行调用</p>
<p>也可在setting.py文件中自行设置</p>
<p><img src="https://cdn.jsdelivr.net/gh/mrthere3/typora_note/img/js/202208051712055.png" srcset="/img/loading94.gif" lazyload></p>
<h2 id="5-DJANGO-模板语法"><a href="#5-DJANGO-模板语法" class="headerlink" title="5. DJANGO 模板语法"></a>5. <em>DJANGO</em> 模板语法</h2><p>本质上：在html中写一些占位符，由数据对这些占位符进行替换和处理。 </p>
<figure><div class="code-wrapper"><pre class="line-numbers language-HTML" data-language="HTML"><code class="language-HTML">&lt;!DOCTYPE html&gt;
&lt;html lang&#x3D;&quot;en&quot;&gt;
&lt;head&gt;
    &lt;meta charset&#x3D;&quot;UTF-8&quot;&gt;
    &lt;title&gt;Title&lt;&#x2F;title&gt;
&lt;&#x2F;head&gt;
&lt;body&gt;
    &lt;ul&gt;
        &#123;% for i in data_list %&#125;
            &lt;li&gt;&#123;&#123; i &#125;&#125;&lt;&#x2F;li&gt;
        &#123;% endfor %&#125;
    &lt;&#x2F;ul&gt;

&lt;&#x2F;body&gt;
&lt;&#x2F;html&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<p>模板中使用特定的模板语法</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> django<span class="token punctuation">.</span>shortcuts <span class="token keyword">import</span> render<span class="token punctuation">,</span>HttpResponse

<span class="token comment"># Create your views here.</span>
<span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span><span class="token string">'index.html'</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span><span class="token string">'data_list'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'发票'</span><span class="token punctuation">,</span> <span class="token string">'海关缴款书'</span><span class="token punctuation">,</span> <span class="token string">'代扣代缴'</span><span class="token punctuation">,</span> <span class="token string">'农产品加计扣除发票信息'</span><span class="token punctuation">,</span> <span class="token string">'农产品加计扣除海关文书'</span><span class="token punctuation">,</span> <span class="token string">'异常发票'</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<p><code>在视图函数，使用json格式进行前后端的交互</code></p>
<figure><div class="code-wrapper"><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token punctuation">&#123;</span>#<span class="token operator">&lt;</span>p<span class="token operator">></span>过滤器<span class="token operator">:</span><span class="token punctuation">(</span><span class="token operator">|</span><span class="token punctuation">)</span>  将管道符左边的数据当做第一个参数传入过滤器中如果需要第二个参数 则名称后冒号<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span>#<span class="token punctuation">&#125;</span>
<span class="token operator">&lt;</span>p<span class="token operator">></span>统计长度<span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span> l<span class="token operator">|</span>length <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span>
<span class="token operator">&lt;</span>p<span class="token operator">></span>加法运算<span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span> i<span class="token operator">|</span>add<span class="token operator">:</span><span class="token number">123</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span>
<span class="token operator">&lt;</span>p<span class="token operator">></span>默认值<span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span> b<span class="token operator">|</span><span class="token keyword">default</span><span class="token operator">:</span><span class="token string">'布尔值为False'</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span>
<span class="token operator">&lt;</span>p<span class="token operator">></span>时间格式<span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span> ctime<span class="token operator">|</span>date<span class="token operator">:</span><span class="token string">'Y-m-d H:i:s'</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span>
<span class="token operator">&lt;</span>p<span class="token operator">></span><span class="token function">截取字符</span><span class="token punctuation">(</span>包含三个点<span class="token punctuation">)</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span> ss<span class="token operator">|</span>truncatechars<span class="token operator">:</span><span class="token number">10</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span>
<span class="token operator">&lt;</span>p<span class="token operator">></span><span class="token function">截取单词</span><span class="token punctuation">(</span>不包含三个点<span class="token punctuation">)</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span> ss<span class="token operator">|</span>truncatewords<span class="token operator">:</span><span class="token number">3</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span>
<span class="token operator">&lt;</span>p<span class="token operator">></span>文件大小<span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span> file_size<span class="token operator">|</span>filesizeformat <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span>
<span class="token operator">&lt;</span>p<span class="token operator">></span>转义<span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span> s1<span class="token operator">|</span>safe <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span>
<span class="token operator">&lt;</span>p<span class="token operator">></span>标签<span class="token operator">:</span>其实就是流程控制 <span class="token keyword">if</span>判断  <span class="token keyword">for</span>循环<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span>
<span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token keyword">for</span> foo <span class="token keyword">in</span> s <span class="token operator">%</span><span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token keyword">if</span> forloop<span class="token punctuation">.</span>first <span class="token operator">%</span><span class="token punctuation">&#125;</span>
        <span class="token operator">&lt;</span>p<span class="token operator">></span>这是第一次循环<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span>
    <span class="token punctuation">&#123;</span><span class="token operator">%</span> elif forloop<span class="token punctuation">.</span>last <span class="token operator">%</span><span class="token punctuation">&#125;</span>
        <span class="token operator">&lt;</span>p<span class="token operator">></span>这是最后一次<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span>
    <span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token keyword">else</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span>
        <span class="token operator">&lt;</span>p<span class="token operator">></span>继续<span class="token operator">!</span><span class="token operator">!</span><span class="token operator">!</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span>
    <span class="token punctuation">&#123;</span><span class="token operator">%</span> endif <span class="token operator">%</span><span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#123;</span><span class="token operator">%</span> empty <span class="token operator">%</span><span class="token punctuation">&#125;</span>
        <span class="token operator">&lt;</span>p<span class="token operator">></span>传递过来的数据是空的<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span>
<span class="token punctuation">&#123;</span><span class="token operator">%</span> endfor <span class="token operator">%</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<p>以下三张</p>
<p><img src="https://img-blog.csdnimg.cn/65ead6b1b4b74f5f8450fbb495ffc2fc.png" srcset="/img/loading94.gif" lazyload></p>
<p><img src="https://img-blog.csdnimg.cn/c847a5f7347745bfbaab0cf3f2e91e37.png" srcset="/img/loading94.gif" lazyload></p>
<p><img src="https://img-blog.csdnimg.cn/c64b5070d7714ea59433c874987e2a82.png" srcset="/img/loading94.gif" lazyload></p>
<h2 id="6-交互与响应"><a href="#6-交互与响应" class="headerlink" title="6.交互与响应"></a>6.交互与响应</h2><h3 id="request交互对象详解"><a href="#request交互对象详解" class="headerlink" title="request交互对象详解"></a>request交互对象详解</h3><figure><div class="code-wrapper"><pre class="line-numbers language-tcl" data-language="tcl"><code class="language-tcl">Request
　　我们知道当URLconf文件匹配到用户输入的路径后，会调用对应的view函数，并将 HttpRequest对象 作为第一个参数传入该函数。

我们来看一看这个HttpRequest对象有哪些属性或者方法：
1 HttpRequest.scheme 　 请求的协议，一般为http或者https，字符串格式<span class="token punctuation">(</span>以下属性中若无特殊指明，均为字符串格式<span class="token punctuation">)</span>

2 HttpRequest.body 　　 http请求的主体，二进制格式。

3 HttpRequest.path 所请求页面的完整路径<span class="token punctuation">(</span>但不包括协议以及域名<span class="token punctuation">)</span>，也就是相对于网站根目录的路径。

4 HttpRequest.path_info 获取具有 URL 扩展名的资源的附加路径信息。相对于HttpRequest.path，使用该方法便于移植。

<span class="token builtin">if</span> the WSGIScriptAlias for your application is set to “<span class="token operator">/</span>minfo”, then path might be “<span class="token operator">/</span>minfo<span class="token operator">/</span>music<span class="token operator">/</span>bands<span class="token operator">/</span>the_beatles<span class="token operator">/</span>” and path_info would be “<span class="token operator">/</span>music<span class="token operator">/</span>bands<span class="token operator">/</span>the_beatles<span class="token operator">/</span>”.
5 HttpRequest.method 获取该请求的方法，比如： GET POST …

6 HttpRequest.encoding 获取请求中表单提交数据的编码。

7 HttpRequest.content_type 获取请求的MIME类型<span class="token punctuation">(</span>从CONTENT_TYPE头部中获取<span class="token punctuation">)</span>，django1.10的新特性。

8 HttpRequest.content_params 获取CONTENT_TYPE中的键值对参数，并以字典的方式表示，django1.10的新特性。

9 HttpRequest.GET 返回一个 querydict 对象<span class="token punctuation">(</span>类似于字典，本文最后有querydict的介绍<span class="token punctuation">)</span>，该对象包含了所有的HTTP GET参数

10 HttpRequest.POST 返回一个 querydict ，该对象包含了所有的HTTP POST参数，通过表单上传的所有 字符 都会保存在该属性中。

11 HttpRequest.COOKIES 　 返回一个包含了所有cookies的字典。

12 HttpRequest.FILES 　　 返回一个包含了所有的上传文件的 querydict 对象。通过表单所上传的所有 文件 都会保存在该属性中。

key的值是input标签中name属性的值，value的值是一个UploadedFile对象

13 HttpRequest.META 返回一个包含了所有http头部信息的字典

View Code
14 HttpRequest.session 中间件属性

15 HttpRequest.site　　 中间件属性

16 HttpRequest.user　　 中间件属性，表示当前登录的用户。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h3 id="响应的方式"><a href="#响应的方式" class="headerlink" title="响应的方式"></a>响应的方式</h3><figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> django<span class="token punctuation">.</span>shortcuts <span class="token keyword">import</span> render<span class="token punctuation">,</span>HttpResponse

<span class="token comment"># Create your views here.</span>
<span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> HttpResponse <span class="token punctuation">(</span><span class="token string">"返回内容"</span><span class="token punctuation">)</span>
<span class="token comment">#HttpResponse 将后面的内容返回</span>

<span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> redirect <span class="token punctuation">(</span><span class="token string">"https://baidu.com"</span><span class="token punctuation">)</span>
<span class="token comment">#redirect 重定向到别的网址</span>
<span class="token keyword">def</span> <span class="token function">_get_queryset</span><span class="token punctuation">(</span>klass<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token triple-quoted-string string">"""
	从模型、管理器或QuerySet中返回一个QuerySet。为了使get_object_or_404和get_list_or_404更加DRY(代码不重复)。
	如果klass不是Modle、Manager或QuerySet，那么就会产生一个ValueError。
	"""</span>
<span class="token keyword">def</span> <span class="token function">get_object_or_404</span><span class="token punctuation">(</span>klass<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token triple-quoted-string string">"""
	使用get()返回一个对象如果对象不存在返回Http404异常。
	klass可能是一个Model、Manager或QuerySet对象; get()查询中使用了参数和关键字参数。
	注意: 就像get()一样，如果有多个返回对象，则返回多个对象。
	"""</span>
<span class="token keyword">def</span> <span class="token function">get_list_or_404</span><span class="token punctuation">(</span>klass<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token triple-quoted-string string">"""
	使用filter()返回一个对象列表,如果列表为空则返回一个Http404异常
	klass可能是一个Model、Manager或QuerySet对象。
	filter()查询中使用了参数和关键字参数。
	"""</span>
<span class="token keyword">def</span> <span class="token function">resolve_url</span><span class="token punctuation">(</span>to<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token triple-quoted-string string">"""
	返回一个与所传递参数相对应的URL。
	参数可以是:
	*模型:模型的get_absolute_url()函数将被调用。
	*视图名称，可能带有参数:' urlresolvers.reverse()将用于反向解析名称。
	*一个URL，它将按原样返回。
	"""</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h3 id="登录案例"><a href="#登录案例" class="headerlink" title="登录案例"></a>登录案例</h3><p>登陆界面</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">login</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">"GET"</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span><span class="token string">"login.html"</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>POST<span class="token punctuation">)</span>
        <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span><span class="token string">"登陆成功"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<figure><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
    &#123;% csrf_token %&#125;
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span>  <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post<span class="token punctuation">"</span></span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/login/<span class="token punctuation">"</span></span> <span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>用户名<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>用户名<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>密码<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>密码<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>提交<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<p><code>django和flask不同，在进行表单校验，多一个&#123;% csrf_token %&#125;安全机制校验，不加校验，无法实现登陆成功的响应。</code></p>
<h2 id="7-DJANGO-ORM"><a href="#7-DJANGO-ORM" class="headerlink" title="7.DJANGO ORM"></a>7.<em>DJANGO</em> ORM</h2><figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python">pip install mysqlclient<span class="token operator">==</span><span class="token number">1.4</span><span class="token number">.1</span> <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></figure>

<h4 id="1修改配置文件"><a href="#1修改配置文件" class="headerlink" title="1修改配置文件"></a>1修改配置文件</h4><figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#在sentting.py</span>
DATABASES <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    <span class="token string">'default'</span> <span class="token punctuation">:</span> <span class="token punctuation">&#123;</span>
        <span class="token string">'ENGINE'</span> <span class="token punctuation">:</span> <span class="token string">'django.db.backends.mysql'</span><span class="token punctuation">,</span>
        <span class="token string">'NAME'</span> <span class="token punctuation">:</span> <span class="token string">'django_db'</span><span class="token punctuation">,</span>
        <span class="token string">'USER'</span> <span class="token punctuation">:</span> <span class="token string">'root'</span><span class="token punctuation">,</span>
        <span class="token string">'PASSWORD'</span> <span class="token punctuation">:</span> <span class="token string">'123456'</span><span class="token punctuation">,</span>
        <span class="token string">'HOST'</span> <span class="token punctuation">:</span> <span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span>
        <span class="token string">'POST'</span> <span class="token punctuation">:</span> <span class="token string">'3306'</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h4 id="2-在models-py创建表类"><a href="#2-在models-py创建表类" class="headerlink" title="2.在models.py创建表类"></a>2.在models.py创建表类</h4><figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python">
<span class="token comment">#django底层会根据类，来生成对应的表和字段from django.db import models #继承models.Model</span>
<span class="token keyword">class</span> <span class="token class-name">UserInfo</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    name <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">)</span>                        <span class="token comment"># primary_key = True</span>
    password <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">)</span>                    <span class="token comment"># 修改表的时候，可以直接添加一行或去掉。 </span>
    age <span class="token operator">=</span> models<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>default<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>                          <span class="token comment"># 默认为2</span>
    <span class="token comment"># data = models.IntegerField(null=True, blank=True)           # 允许为空</span>
    <span class="token comment"># account = models.DecimalField(max_digits=10, decimal_places=2， default = 0)  # 总长度10位， 小数2位, 默认0.</span>
    <span class="token comment"># create_time = models.DateTimeField()                        # 时间 </span>
    <span class="token comment"># on_delete=models.CASCADE 级联删除， models.SET_NULL 设置为空。</span>
    <span class="token comment"># depart = models.ForeignKey(to='Department', to_field='id')  # 生成depart_id字段，和Department的to_field关联</span>
    <span class="token comment"># gender_choices = (</span>
    <span class="token comment">#    (1, "男"),</span>
    <span class="token comment">#    (2, "女"),)</span>
    <span class="token comment"># gender = models.SmallIntegerField(verbose_name="性别", choices=gender_choices)  # 选着约束</span>
<span class="token comment">#django底层会根据类，来生成对应的表和字段</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h4 id="3-执行数据初始化脚本"><a href="#3-执行数据初始化脚本" class="headerlink" title="3.执行数据初始化脚本"></a>3.执行数据初始化脚本</h4><figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python">python manage<span class="token punctuation">.</span>py makemigrations
python manage<span class="token punctuation">.</span>py migrate<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div></figure>

<h4 id="4-使用orm操作数据库表的数据"><a href="#4-使用orm操作数据库表的数据" class="headerlink" title="4.使用orm操作数据库表的数据"></a>4.使用orm操作数据库表的数据</h4><h5 id="1-orm用法与字段类型"><a href="#1-orm用法与字段类型" class="headerlink" title="1.orm用法与字段类型"></a>1.orm用法与字段类型</h5><figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"> Meta 选项<span class="token punctuation">.</span> 没有一个选项是必需的<span class="token punctuation">.</span> 是否添加 <span class="token keyword">class</span> <span class="token class-name">Meta</span> 到你的 model 完全是可选的。

<span class="token number">1</span>、db_table 
本模块在数据库中对应的表的名字<span class="token punctuation">:</span>

db_table <span class="token operator">=</span> <span class="token string">"pizza_orders"</span>

若不提供该参数<span class="token punctuation">,</span> Django 会使用 app_label <span class="token operator">+</span> <span class="token string">'_'</span> <span class="token operator">+</span> module_name 作为表的名字。

若表的名字是一个 SQL 保留字<span class="token punctuation">,</span> 或包含 Python 变量名不允许的字符<span class="token operator">-</span><span class="token operator">-</span>特别是连字符 <span class="token operator">-</span><span class="token operator">-</span>没关系<span class="token punctuation">.</span> Django 会自动在幕后替你将列名字和表名字用引号引起来<span class="token punctuation">.</span>

<span class="token number">2</span>、get_latest_by 

一个 DateField 或 DateTimeField 字段的名字<span class="token punctuation">.</span> 若提供该选项<span class="token punctuation">,</span> 该模块将拥有一个 get_latest<span class="token punctuation">(</span><span class="token punctuation">)</span> 函数以得到 <span class="token string">"最新的"</span> 对象<span class="token punctuation">(</span>依据那个字段<span class="token punctuation">)</span><span class="token punctuation">:</span>

get_latest_by <span class="token operator">=</span> <span class="token string">"order_date"</span>。

<span class="token number">3</span>、order_with_respect_to 

将该对象标记为可按给定字段排序<span class="token punctuation">.</span> This <span class="token keyword">is</span> almost always used <span class="token keyword">with</span> related objects to allow them to be ordered <span class="token keyword">with</span> respect to a parent <span class="token builtin">object</span><span class="token punctuation">.</span> 举例来说<span class="token punctuation">,</span> 如果一个 PizzaToppping 关联到一个 Pizza 对象<span class="token punctuation">,</span> 你可以使用<span class="token punctuation">:</span>

order_with_respect_to <span class="token operator">=</span> <span class="token string">'pizza'</span>

这就允许 toppings 被排序to be ordered 关于相关的 pizza 对象

<span class="token number">4</span>、ordering 

默认排序字段及排序方式<span class="token punctuation">,</span> 用于得到一个对象列表的任何场合<span class="token punctuation">:</span>

ordering <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'-order_date'</span><span class="token punctuation">]</span>

这是一个 <span class="token builtin">tuple</span> 或一个字符串列表<span class="token punctuation">.</span> 每个字符串是一个字段名带及一个可选的前缀 <span class="token string">"-"</span> <span class="token punctuation">,</span> 这个前缀表示按降序排序<span class="token punctuation">(</span>递减<span class="token punctuation">)</span><span class="token punctuation">.</span> 若没有这个前缀<span class="token punctuation">,</span>则表示按升序排序<span class="token punctuation">.</span>字符串 <span class="token string">"?"</span> 表示随机排序<span class="token punctuation">.</span>

举个例子<span class="token punctuation">,</span> 要对 pub_date 字段以升序排列<span class="token punctuation">,</span> 这样做<span class="token punctuation">:</span>

ordering <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'pub_date'</span><span class="token punctuation">]</span>

要降序排列<span class="token punctuation">,</span> 这样<span class="token punctuation">:</span>

ordering <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'-pub_date'</span><span class="token punctuation">]</span>

要对 pub_date 降序<span class="token punctuation">,</span>然后对 author 升序<span class="token punctuation">,</span> 这样<span class="token punctuation">:</span>

ordering <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'-pub_date'</span><span class="token punctuation">,</span> <span class="token string">'author'</span><span class="token punctuation">]</span>

注意一点<span class="token punctuation">,</span>不论你使用了多少个字段排序<span class="token punctuation">,</span> admin 只使用第一个字段<span class="token punctuation">.</span>

<span class="token number">5</span>、permissions 

要创建一个对象所需要的额外的权限<span class="token punctuation">.</span> 如果一个对象有 admin 设置<span class="token punctuation">,</span> 则每个对象的添加<span class="token punctuation">,</span>删除和改变权限会人<span class="token punctuation">(</span>依据该选项<span class="token punctuation">)</span>自动创建<span class="token punctuation">.</span>下面这个例子指定了一个附加权限<span class="token punctuation">:</span> can_deliver_pizzas<span class="token punctuation">:</span>

permissions <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"can_deliver_pizzas"</span><span class="token punctuation">,</span> <span class="token string">"Can deliver pizzas"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">)</span>

这是一个<span class="token number">2</span><span class="token operator">-</span>元素 <span class="token builtin">tuple</span> 的<span class="token builtin">tuple</span>或列表<span class="token punctuation">,</span> 其中两<span class="token number">2</span><span class="token operator">-</span>元素 <span class="token builtin">tuple</span> 的格式为<span class="token punctuation">:</span><span class="token punctuation">(</span>permission_code<span class="token punctuation">,</span> human_readable_permission_name<span class="token punctuation">)</span><span class="token punctuation">.</span> 

<span class="token number">6</span>、unique_together 

unique_together <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"driver"</span><span class="token punctuation">,</span> <span class="token string">"restaurant"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">)</span>

这是一个字段列表的列表<span class="token punctuation">,</span>这些字段的综合值必须是唯一的<span class="token punctuation">.</span> 这会在 Django admin 层和数据库层同时做出限制<span class="token punctuation">(</span>也就是相关的 UNIQUE 语句会被包括在 CREATE TABLE 语句中<span class="token punctuation">)</span><span class="token punctuation">.</span>

<span class="token number">7</span>、verbose_name 

是该对象的一个可读性更好的唯一名字<span class="token punctuation">:</span>

verbose_name <span class="token operator">=</span> <span class="token string">"pizza"</span>

若未提供该选项<span class="token punctuation">,</span> Django 则会用一个类名字的 munged 版本来代替<span class="token punctuation">:</span> CamelCase becomes camel <span class="token keyword">case</span><span class="token punctuation">.</span>

<span class="token number">8</span>、erbose_name_plural 

对象名字的复数<span class="token punctuation">:</span>

verbose_name_plural <span class="token operator">=</span> <span class="token string">"stories"</span>

若未提供该选项<span class="token punctuation">,</span> Django 会使用 verbose_name <span class="token operator">+</span> <span class="token string">"s"</span><span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>



<figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token number">1</span><span class="token punctuation">.</span>orm用法：属性名 <span class="token operator">=</span> models<span class="token punctuation">.</span>字段类型<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
<span class="token number">2.</span>常见字段类型
    <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>AutoField：    自动增长的IntegerField<span class="token punctuation">,</span> 不指定时Django会自动创建属性名为<span class="token builtin">id</span>的自动增长属性
    <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>IntegerField： 整数
    <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>FloatField（）：浮点数
    <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>DecimalField<span class="token punctuation">(</span>max_digits<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> decimal_places<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>：可以指定精度的十进制浮点数
                                                        max_digits：总位数
                                                        decimal_places：小数位数
    <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>：字符串（max_length：最大字符个数）
                                 必须要指定max_length参数 不指定会直接报错
    <span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>TextFiled：         大文本字段，一般超过<span class="token number">4000</span>个字符时使用
    <span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span>BooleanField：      布尔字段，值为<span class="token boolean">True</span>或<span class="token boolean">False</span>
    <span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>NullBooleanField：  支持Null、<span class="token boolean">True</span>、<span class="token boolean">False</span>三种值                                       
    <span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span>DateField<span class="token punctuation">(</span>auto_now<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> auto_now_add<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>：日期
                参数auto_now：每次保存对象时，自动设置该字段为当前时间，
                              用于<span class="token string">"最后一次修改"</span>的时间戳，它总是使用当前日期，默认为false
                参数auto_now_add：当对象第一次被创建时自动设置当前时间，
                              用于创建的时间戳，它总是使用当前日期，默认为false
                注意：参数auto_now_add和auto_now是相互排斥的，组合将会发生错误
    <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>TimeField<span class="token punctuation">(</span>auto_now<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> auto_now_add<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>：时间
    <span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>DateTimeField：日期时间
    <span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span>FileField：上传文件字段，以二进制的形式
    <span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span>ImageField：继承于FileField，对上传的内容进行校验，确保是有效的图片
 
 
<span class="token number">3.</span>常见字段属性<span class="token punctuation">(</span>选项<span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>null：如果为<span class="token boolean">True</span>，表示允许为空，默认值是<span class="token boolean">False</span>
    <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>blank：如果为<span class="token boolean">True</span>，则该字段允许为空白，默认值是<span class="token boolean">False</span>    
             对比：null是数据库范畴的概念，blank是表单验证范畴的
    <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>db_column：字段的名称，如果未指定，则使用属性的名称
              （只限于数据库表中的名字，操作数据库还是类属性的名字）
    <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>db_index：若值为<span class="token boolean">True</span><span class="token punctuation">,</span> 则在表中会为此字段创建索引，默认值是<span class="token boolean">False</span>（为了优化查询速度 ）
    <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>default：默认值，这可以是值或可调用对象。如果可调用，则每次创建新对象时都会调用它。
    <span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>primary_key：若为<span class="token boolean">True</span>，则该字段会成为模型的主键字段，默认值是<span class="token boolean">False</span>，一般作为AutoField的选项使用
    <span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span>unique：如果为<span class="token boolean">True</span><span class="token punctuation">,</span> 这个字段在表中必须有唯一值，这个值不能重复，默认值是<span class="token boolean">False</span>
    <span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>verbose_name<span class="token punctuation">:</span>该参数是所有字段都有的 就是用来对字段的解释
 
 
<span class="token number">4.</span>关系字段类型<span class="token punctuation">(</span>用法与普通字段类型一样<span class="token punctuation">)</span>
    关系型数据库的关系包括三种类型：
        ForeignKey：        一对多，将字段定义在多的一端中
        ManyToManyField：   多对多，将字段定义在任意一端中
        OneToOneField：     一对一，将字段定义在任意一端中
 
 
<span class="token number">5.</span>字段的的增删改<span class="token punctuation">(</span>记得执行数据库迁移的两条命令<span class="token punctuation">)</span>：
    <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>字段的增加
	    a<span class="token punctuation">.</span>可以在终端内直接给出默认值
        b<span class="token punctuation">.</span>该字段可以为空
            info <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span>verbose_name<span class="token operator">=</span><span class="token string">'个人简介'</span><span class="token punctuation">,</span>null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        c<span class="token punctuation">.</span>直接给字段设置默认值
            hobby <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span>verbose_name<span class="token operator">=</span>'兴趣爱
好<span class="token string">',default='</span>study'<span class="token punctuation">)</span>
        然后执行数据库迁移的两条命令
    <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>字段的修改
	   直接修改代码然后执行数据库迁移的两条命令即可！
    <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>字段的删<span class="token punctuation">(</span>慎重<span class="token punctuation">)</span>
	   直接注释对应的字段然后执行数据库迁移的两条命令即可！
       注意：执行完毕之后字段对应的数据也都没有了
<span class="token number">6.</span> values和 values_list
        user_info <span class="token operator">=</span> UserInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span>request<span class="token punctuation">.</span>GET<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token string">"字段"</span><span class="token punctuation">)</span> 
  <span class="token comment"># 规定 字段名的值返回为字典元素</span>
   valuise_list 规定的为元组
                                     
                                     <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h5 id="2-ORM之查询操作-查询集、过滤器"><a href="#2-ORM之查询操作-查询集、过滤器" class="headerlink" title="2.ORM之查询操作(查询集、过滤器)"></a>2.ORM之查询操作(查询集、过滤器)</h5><figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token number">1.</span>基本概念
    <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>查询集：表示从数据库中获取的模型对象集合<span class="token punctuation">(</span>objects<span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">,</span>在管理器上调用过滤器方法会返回查询集
               查询集可以含有<span class="token number">0</span>个、一个或多个过滤器
       查询集特点<span class="token punctuation">:</span>a<span class="token punctuation">.</span>惰性执行：创建查询集不会访问数据库，直到在模板中调用数据时，才会访问数据库
                             调用数据的情况包括迭代、序列化、与<span class="token keyword">if</span>合用
                 b<span class="token punctuation">.</span>缓存：查询集的结果被存下来之后，再次查询相同数据时会使用之前缓存的数据
    <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>过滤器：基于所给的参数限制查询的结果
 
 
 
<span class="token number">2.</span>过滤器分两类
    <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>返回列表数据的过滤器：
        <span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：       返回所有的数据<span class="token punctuation">(</span>以对象形式<span class="token punctuation">)</span>
        <span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：    返回满足条件的数据，括号内可以携带多个参数，参数与参数之间默认是<span class="token keyword">and</span>关系
        exclude<span class="token punctuation">(</span><span class="token punctuation">)</span>：   返回满足条件之外的数据，相当于sql语句中where部分的<span class="token keyword">not</span>关键字
        order_by<span class="token punctuation">(</span><span class="token punctuation">)</span>：  返回排序后的数据
        注意：返回的是列表对象，即<span class="token punctuation">[</span>数据对象<span class="token number">1</span><span class="token punctuation">,</span>数据对象<span class="token number">2.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>，
              获取对象，它支持索引取值和切片操作，但是不支持负数索引
              获取第一个对象<span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>返回单个对象的过滤器<span class="token punctuation">:</span>
        get<span class="token punctuation">(</span><span class="token punctuation">)</span>：       返回单个满足条件的对象
                      <span class="token comment"># 如果未找到会引发"模型类.DoesNotExist"异常</span>
                      <span class="token comment"># 如果多条被返回，会引发"模型类.MultipleObjectsReturned"异常</span>
        count<span class="token punctuation">(</span><span class="token punctuation">)</span>：     返回当前查询的总条数
        aggregate<span class="token punctuation">(</span><span class="token punctuation">)</span>： 聚合
        exists<span class="token punctuation">(</span><span class="token punctuation">)</span>：    判断查询集中是否有数据，如果有则返回<span class="token boolean">True</span>，没有则返回<span class="token boolean">False</span>
    <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>常见过滤器查询：
        a<span class="token punctuation">.</span>查询<span class="token builtin">id</span>为<span class="token number">1</span>的用户名<span class="token punctuation">(</span>用exact：判断是否相等<span class="token punctuation">)</span>
            usernames <span class="token operator">=</span> models<span class="token punctuation">.</span>User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>id__exact<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
 
        b<span class="token punctuation">.</span>查询姓名中包含<span class="token string">'张'</span>的名字<span class="token punctuation">(</span>用contains：是否包含<span class="token punctuation">)</span>
            usernames <span class="token operator">=</span> models<span class="token punctuation">.</span>User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>username__contains<span class="token operator">=</span><span class="token string">'张'</span><span class="token punctuation">)</span>
 
        c<span class="token punctuation">.</span>查询姓名中以‘欣’结尾的名字<span class="token punctuation">(</span>用startswith<span class="token operator">/</span>endswith：以什么开头<span class="token operator">/</span>以什么结尾<span class="token punctuation">)</span>
            usernames <span class="token operator">=</span> models<span class="token punctuation">.</span>User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>username__endswith<span class="token operator">=</span><span class="token string">'欣'</span><span class="token punctuation">)</span>
 
        d<span class="token punctuation">.</span>查询姓名不为空的成员<span class="token punctuation">(</span>用isnull <span class="token punctuation">:</span> 是否为null<span class="token punctuation">)</span>
            usernames <span class="token operator">=</span> models<span class="token punctuation">.</span>User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>username__isnull<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
 
        e<span class="token punctuation">.</span>查询编号为<span class="token number">2</span>或<span class="token number">4</span>的成员<span class="token punctuation">(</span>pk<span class="token punctuation">:</span>主键<span class="token operator">/</span><span class="token builtin">id</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>用<span class="token keyword">in</span>：是否包含在范围内<span class="token punctuation">)</span>
            usernames <span class="token operator">=</span> models<span class="token punctuation">.</span>User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>pk__in<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
 
        f<span class="token punctuation">.</span>查询编号大于<span class="token number">2</span>的成员（gt<span class="token punctuation">:</span>大于、gte<span class="token punctuation">:</span>大于等于、lt<span class="token punctuation">:</span>小于、lte<span class="token punctuation">:</span>小<span class="token punctuation">)</span>
            usernames <span class="token operator">=</span> models<span class="token punctuation">.</span>User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>id__gt<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
 
        g<span class="token punctuation">.</span>查询<span class="token builtin">id</span>不等于３的成员<span class="token punctuation">(</span>exclude<span class="token punctuation">:</span>条件以外的数据<span class="token punctuation">)</span>
            usernames <span class="token operator">=</span> models<span class="token punctuation">.</span>User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>exclude<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>
 
        h<span class="token punctuation">.</span>查询<span class="token number">2020</span>年注册的成员<span class="token punctuation">(</span>year、month、day、week_day、hour、minute、second：对日期时间类型的属性进行运算<span class="token punctuation">)</span>
            usernames <span class="token operator">=</span> models<span class="token punctuation">.</span>User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>pub_date__year<span class="token operator">=</span><span class="token number">2020</span><span class="token punctuation">)</span>
 
        i<span class="token punctuation">.</span>查询<span class="token number">2020</span>年<span class="token number">1</span>月<span class="token number">1</span>日后注册的成员
            <span class="token keyword">from</span> datetime <span class="token keyword">import</span> date
            usernames <span class="token operator">=</span> models<span class="token punctuation">.</span>User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>pub_date__gt<span class="token operator">=</span>date<span class="token punctuation">(</span><span class="token number">2020</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        h<span class="token punctuation">.</span> 多条件查询
        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"id"</span><span class="token operator">=</span><span class="token string">"3"</span><span class="token punctuation">,</span><span class="token string">"moible"</span><span class="token operator">=</span><span class="token string">"123"</span><span class="token punctuation">&#125;</span>
        usernames <span class="token operator">=</span> models<span class="token punctuation">.</span>User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token operator">**</span>data<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python">在views<span class="token punctuation">.</span>py中对数据库数据的增删改查
<span class="token keyword">from</span> app01 <span class="token keyword">import</span> models
<span class="token number">1.</span>查数据
    <span class="token comment"># 方式一</span>
        res <span class="token operator">=</span> models<span class="token punctuation">.</span>User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>username<span class="token operator">=</span>username<span class="token punctuation">)</span>
            <span class="token triple-quoted-string string">"""
            返回值你先看成是列表套数据对象的格式
            它也支持索引取值，切片操作，但是不支持负数索引
            它也不推荐你使用索引的方式取值
            user_obj = models.User.objects.filter(username=username).first()
            filter括号内可以携带多个参数 参数与参数之间默认是and关系
            """</span>
        <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span><span class="token string">'userlist.html'</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span><span class="token string">'user_queryset'</span><span class="token punctuation">:</span>user_queryset<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    <span class="token comment"># 指定返回</span>
    <span class="token comment"># 方式二</span>
        user_queryset <span class="token operator">=</span> models<span class="token punctuation">.</span>User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span><span class="token string">'userlist.html'</span><span class="token punctuation">,</span><span class="token builtin">locals</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment"># 全部返回</span>
 
 
<span class="token number">2.</span>增数据
    <span class="token comment"># 方法一：</span>
    res <span class="token operator">=</span> models<span class="token punctuation">.</span>User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>create<span class="token punctuation">(</span>username<span class="token operator">=</span>username<span class="token punctuation">,</span>password<span class="token operator">=</span>password<span class="token punctuation">)</span>  <span class="token comment"># 返回值就是当前被创建的对象本身</span>
    <span class="token comment"># 方法二：</span>
    user_obj <span class="token operator">=</span> models<span class="token punctuation">.</span>User<span class="token punctuation">(</span>username<span class="token operator">=</span>username<span class="token punctuation">,</span>password<span class="token operator">=</span>password<span class="token punctuation">)</span>
    user_obj<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>              <span class="token comment"># 保存数据/对象调用save方法</span>
 
 
<span class="token number">3.</span>删数据
    models<span class="token punctuation">.</span>User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>id_user<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>delete<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment"># 指定删除id_user=1的数据</span>
 
 
<span class="token number">4.</span>改数据
    <span class="token comment"># 方式一：</span>
    models<span class="token punctuation">.</span>User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span>edit_id<span class="token punctuation">)</span><span class="token punctuation">.</span>update<span class="token punctuation">(</span>username<span class="token operator">=</span>username<span class="token punctuation">,</span>password<span class="token operator">=</span>password<span class="token punctuation">)</span>
        <span class="token comment"># 将filter查询出来的列表中所有的对象全部更新，批量更新操作，只修改被修改的字段</span>
    <span class="token comment"># 方式二：</span>
    edit_obj<span class="token punctuation">.</span>username <span class="token operator">=</span> username
    edit_obj<span class="token punctuation">.</span>password<span class="token operator">=</span> password
    edit_obj<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment"># 用重新赋值方式，全部逐一更换当字段特别多的时候效率会非常的低</span>
        <span class="token comment"># 因为从头到尾，无论该字段是否被修改都将数据的所有字段全部更新一边 </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h4 id="5-案例"><a href="#5-案例" class="headerlink" title="5.案例"></a>5.案例</h4><figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> django<span class="token punctuation">.</span>db <span class="token keyword">import</span> models
<span class="token keyword">class</span> <span class="token class-name">Department</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    title <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>verbose_name<span class="token operator">=</span><span class="token string">"部门名称"</span><span class="token punctuation">,</span>max_length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">UserInfo</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    name <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span>verbose_name<span class="token operator">=</span><span class="token string">"姓名"</span><span class="token punctuation">)</span>                        <span class="token comment"># primary_key = True</span>
    password <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>verbose_name<span class="token operator">=</span><span class="token string">"密码"</span><span class="token punctuation">,</span>max_length<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">)</span>                    <span class="token comment"># 修改表的时候，可以直接添加一行或去掉。</span>
    age <span class="token operator">=</span> models<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>verbose_name<span class="token operator">=</span><span class="token string">"年龄"</span><span class="token punctuation">)</span>    <span class="token comment"># 默认为2</span>
    count <span class="token operator">=</span> models<span class="token punctuation">.</span>DecimalField<span class="token punctuation">(</span>verbose_name<span class="token operator">=</span><span class="token string">"余额"</span><span class="token punctuation">,</span>max_digits<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span>decimal_places<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>default<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
    create_time <span class="token operator">=</span> models<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span>validators<span class="token operator">=</span><span class="token string">"入职时间"</span><span class="token punctuation">)</span>
    <span class="token comment"># depart_id = models.BigIntegerField(verbose_name="部门id")</span>
    <span class="token comment">#设置外键</span>
    deaprt <span class="token operator">=</span> models<span class="token punctuation">.</span>ForeignKey<span class="token punctuation">(</span>to<span class="token operator">=</span><span class="token string">"Department"</span><span class="token punctuation">,</span>to_fields<span class="token operator">=</span><span class="token string">"id"</span><span class="token punctuation">,</span>on_delete<span class="token operator">=</span>models<span class="token punctuation">.</span>CASCADE<span class="token punctuation">)</span>
    <span class="token comment">#on_delete 这是数据库外键定义的一个可选项，用来设置当主键表中的被参考列的数据发生变化时，外键表中响应字段的变换规则的。</span>
	<span class="token triple-quoted-string string">"""
on_update 和 on_delete 后面可以跟的词语有四个
1. no action 表示 不做任何操作，
2. set null 表示在外键表中将相应字段设置为null
3. set default 表示设置为默认值
4. cascade 表示级联操作，就是说，如果主键表中被参考字段更新，外键表中也更新，主键表中的记录被删除，外键表中改行也相应删除
	"""</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h5 id="7-5-1部门列表"><a href="#7-5-1部门列表" class="headerlink" title="7.5.1部门列表"></a>7.5.1部门列表</h5><figure><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span><span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mydj/static/bootstrap/dist/css/bootstrap.min.css<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mydj/static/jquery/dist/jquery.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mydj/static/bootstrap/dist/js/bootstrap.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div></figure>

<ul>
<li>静态文件路径如图所示</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/mrthere3/typora_note/img/js/202208161405343.png" srcset="/img/loading94.gif" lazyload></p>
<ul>
<li><p>配置文件路径如下</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup">STATIC_URL = '/static/'

STATICFILES_DIRS = [(os.path.join(BASE_DIR, 'static'))]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div></figure>
</li>
<li><p>导入静态文件</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup">&#123;% load static %&#125;
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/css<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>&#123;% static 'bootstrap/dist/css/bootstrap.css' %&#125;<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css">
        <span class="token selector">.navbar</span> <span class="token punctuation">&#123;</span>
            <span class="token property">border-radius</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>nav</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>navbar navbar-default<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token comment">&lt;!-- Brand and toggle get grouped for better mobile display --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>navbar-header<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>navbar-toggle collapsed<span class="token punctuation">"</span></span> <span class="token attr-name">data-toggle</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>collapse<span class="token punctuation">"</span></span>
                    <span class="token attr-name">data-target</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#bs-example-navbar-collapse-1<span class="token punctuation">"</span></span> <span class="token attr-name">aria-expanded</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>sr-only<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Toggle navigation<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>icon-bar<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>icon-bar<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>icon-bar<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>navbar-brand<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>联通用户管理 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>

        <span class="token comment">&lt;!-- Collect the nav links, forms, and other content for toggling --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>collapse navbar-collapse<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>bs-example-navbar-collapse-1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>nav navbar-nav<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>active<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>部门管理 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>sr-only<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>(current)<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>用户管理<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>nav navbar-nav navbar-right<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>登录<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>
                &#123;#                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>登出<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>#&#125;
                &#123;#                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Link<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>#&#125;
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dropdown<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dropdown-toggle<span class="token punctuation">"</span></span> <span class="token attr-name">data-toggle</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dropdown<span class="token punctuation">"</span></span> <span class="token attr-name">role</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">aria-haspopup</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span>
                       <span class="token attr-name">aria-expanded</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>李洛克<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>caret<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dropdown-menu<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>个人资料 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>我的信息<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">role</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>separator<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>divider<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>注销<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token comment">&lt;!-- /.navbar-collapse --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token comment">&lt;!-- /.container-fluid --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>nav</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">margin-bottom</span><span class="token punctuation">:</span> 10px</span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-primary btn-success <span class="token punctuation">"</span></span> <span class="token attr-name">data-toggle</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>modal<span class="token punctuation">"</span></span> <span class="token attr-name">data-target</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#exampleModal<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>glyphicon glyphicon-eject<span class="token punctuation">"</span></span> <span class="token attr-name">aria-hidden</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>
                新建部门<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>modal fade<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>exampleModal<span class="token punctuation">"</span></span> <span class="token attr-name">tabindex</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>-1<span class="token punctuation">"</span></span> <span class="token attr-name">role</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dialog<span class="token punctuation">"</span></span>
                 <span class="token attr-name">aria-labelledby</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>exampleModalLabel<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>modal-dialog<span class="token punctuation">"</span></span> <span class="token attr-name">role</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>document<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>modal-content<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>modal-header<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
                            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>close<span class="token punctuation">"</span></span> <span class="token attr-name">data-dismiss</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>modal<span class="token punctuation">"</span></span> <span class="token attr-name">aria-label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Close<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span>
                                    <span class="token attr-name">aria-hidden</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token entity named-entity" title="&times;">&amp;times;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
                            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h4</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>modal-title<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>exampleModalLabel<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>新建部门<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h4</span><span class="token punctuation">></span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>modal-body<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
                            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/depart/add/<span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">onsubmit</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value javascript language-javascript"><span class="token keyword">return</span> <span class="token function">isempty</span><span class="token punctuation">(</span><span class="token string">'#deparment-name'</span><span class="token punctuation">)</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span>
                                &#123;% csrf_token %&#125;
                                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-group<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
                                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>recipient-name<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>control-label<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>部门名称:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>
                                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-control<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>deparment-name<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>depart_name<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
                                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
                                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-group<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
                                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>message-text<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>control-label<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>部门人员<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>
                                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>textarea</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-control<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>message-text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>depart_length<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>textarea</span><span class="token punctuation">></span></span>
                                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
                                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>modal-footer<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
                                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-default<span class="token punctuation">"</span></span> <span class="token attr-name">data-dismiss</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>modal<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>关闭<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
                                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-primary<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>保存<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
                                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
                            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>panel panel-default<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
            <span class="token comment">&lt;!-- Default panel contents --></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>panel-heading<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>glyphicon glyphicon-list<span class="token punctuation">"</span></span> <span class="token attr-name">aria-hidden</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>
                部门列表
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>

            <span class="token comment">&lt;!-- Table --></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>table table-bordered<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>thead</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>ID<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>名称<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>操作<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>thead</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tbody</span><span class="token punctuation">></span></span>
                &#123;% for i in depart_list %&#125;
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span> <span class="token attr-name">scope</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>row<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>&#123;&#123; start_index|add:forloop.counter &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>&#123;&#123; i.title &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>
                            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn-primary btn-sm<span class="token punctuation">"</span></span> <span class="token attr-name">data-toggle</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>modal<span class="token punctuation">"</span></span> <span class="token attr-name">data-target</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#exampleModal2<span class="token punctuation">"</span></span>
                               <span class="token attr-name">data-whatever</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>&#123;&#123; i.title &#125;&#125;<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>编辑<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>
                            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn-danger btn-sm<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/depart/delete/?nid=&#123;&#123; i.id &#125;&#125;<span class="token punctuation">"</span></span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>_parent<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>删除<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>
                &#123;% endfor %&#125;
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>modal fade<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>exampleModal2<span class="token punctuation">"</span></span> <span class="token attr-name">tabindex</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>-1<span class="token punctuation">"</span></span> <span class="token attr-name">role</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dialog<span class="token punctuation">"</span></span>
                     <span class="token attr-name">aria-labelledby</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>exampleModalLabel<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>modal-dialog<span class="token punctuation">"</span></span> <span class="token attr-name">role</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>document<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>modal-content<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
                            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>modal-header<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
                                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>close<span class="token punctuation">"</span></span> <span class="token attr-name">data-dismiss</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>modal<span class="token punctuation">"</span></span> <span class="token attr-name">aria-label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Close<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
                                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">aria-hidden</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token entity named-entity" title="&times;">&amp;times;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
                                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h4</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>modal-title<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>exampleModalLabel<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>部门名称编辑<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h4</span><span class="token punctuation">></span></span>
                            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
                            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>modal-body<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
                                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post<span class="token punctuation">"</span></span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/depart/edit/<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>deaprt_edit<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">onsubmit</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value javascript language-javascript"><span class="token keyword">return</span> <span class="token function">isempty</span><span class="token punctuation">(</span><span class="token string">'#deparment-name1'</span><span class="token punctuation">)</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span>
                                    &#123;% csrf_token %&#125;
                                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-group<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
                                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>recipient-name<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>control-label<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>部门名称<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>
                                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-control<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>deparment-title<span class="token punctuation">"</span></span>  <span class="token attr-name">readonly</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>old_depart_name<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
                                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
                                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-group<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
                                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>message-text<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>control-label<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>新部门名称<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>
                                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-control<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>deparment-name1<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>depart_name<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
                                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
                                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span>
                                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>modal-footer<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
                                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-default<span class="token punctuation">"</span></span> <span class="token attr-name">data-dismiss</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>modal<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>关闭
                                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
                                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-primary<span class="token punctuation">"</span></span> <span class="token attr-name">form</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>deaprt_edit<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>提交<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
                                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
                            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>

                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tbody</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>&#123;% static '/jquery/dist/jquery.js' %&#125;<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>&#123;% static '/bootstrap/dist/js/bootstrap.js' %&#125;<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/css<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://www.huangwx.cn/css/sweetalert.css<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://www.huangwx.cn/js/sweetalert-dev.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">function</span> <span class="token function">isempty</span><span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">var</span> res <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> res2 <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#message-text"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> res2<span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>res2<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token function">swal</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">"数据不能为空"</span><span class="token punctuation">,</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">"error"</span><span class="token punctuation">,</span> <span class="token literal-property property">confirmButtonText</span><span class="token operator">:</span> <span class="token string">"确定"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
                <span class="token keyword">return</span> <span class="token boolean">false</span>
            <span class="token punctuation">&#125;</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#exampleModal2'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'show.bs.modal'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">var</span> button <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>relatedTarget<span class="token punctuation">)</span> <span class="token comment">// Button that triggered the modal</span>
            <span class="token keyword">var</span> recipient <span class="token operator">=</span> button<span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token string">'whatever'</span><span class="token punctuation">)</span> <span class="token comment">// Extract info from data-* attributes</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>recipient<span class="token punctuation">)</span>
            <span class="token comment">// If necessary, you could initiate an AJAX request here (and then do the updating in a callback).</span>
            <span class="token comment">// Update the modal's content. We'll use jQuery here, but you could use a data binding library or other methods instead.</span>
            <span class="token keyword">var</span> modal <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">this</span></span><span class="token punctuation">)</span>
            <span class="token punctuation">&#123;</span>#modal<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'.modal-title'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">'New message to '</span> <span class="token operator">+</span> recipient<span class="token punctuation">)</span>#<span class="token punctuation">&#125;</span>
            modal<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'.modal-body input:eq(1)'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span>recipient<span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span><span class="token keyword">catch</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>
</li>
<li><p>例如下列视图函数</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> time

<span class="token keyword">from</span> django<span class="token punctuation">.</span>shortcuts <span class="token keyword">import</span> render<span class="token punctuation">,</span>HttpResponse<span class="token punctuation">,</span>redirect
<span class="token keyword">from</span> app01<span class="token punctuation">.</span>models <span class="token keyword">import</span> Department
<span class="token keyword">from</span> django<span class="token punctuation">.</span>contrib <span class="token keyword">import</span> messages
<span class="token keyword">from</span> django<span class="token punctuation">.</span>core<span class="token punctuation">.</span>paginator <span class="token keyword">import</span> Paginator

Create your views here<span class="token punctuation">.</span>
<span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span><span class="token string">'index.html'</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span><span class="token string">'data_list'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'发票'</span><span class="token punctuation">,</span> <span class="token string">'海关缴款书'</span><span class="token punctuation">,</span> <span class="token string">'代扣代缴'</span><span class="token punctuation">,</span> <span class="token string">'农产品加计扣除发票信息'</span><span class="token punctuation">,</span> <span class="token string">'农产品加计扣除海关文书'</span><span class="token punctuation">,</span> <span class="token string">'异常发票'</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token comment">#</span>
<span class="token keyword">def</span> <span class="token function">depart_index</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    index <span class="token operator">=</span><span class="token number">1</span>
    page_size <span class="token operator">=</span> <span class="token number">10</span>
    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">"GET"</span><span class="token punctuation">:</span>
        index <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>GET<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"index"</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        page_size <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>GET<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"pagesize"</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    query_set <span class="token operator">=</span> Department<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    paginator <span class="token operator">=</span> Paginator<span class="token punctuation">(</span>query_set<span class="token punctuation">,</span> page_size<span class="token punctuation">)</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        pages <span class="token operator">=</span> paginator<span class="token punctuation">.</span>page<span class="token punctuation">(</span>index<span class="token punctuation">)</span> <span class="token comment"># 可能请求的页数大于 实际分页数目</span>
    <span class="token keyword">except</span><span class="token punctuation">:</span>
        index <span class="token operator">=</span> paginator<span class="token punctuation">.</span>num_pages <span class="token comment">#针对超出直接返回到最后一页数据</span>
        last <span class="token operator">=</span> paginator<span class="token punctuation">.</span>num_pages
        pages <span class="token operator">=</span> paginator<span class="token punctuation">.</span>page<span class="token punctuation">(</span>last<span class="token punctuation">)</span>
    <span class="token comment"># print(query_set)</span>
    startindex <span class="token operator">=</span> page_size<span class="token operator">*</span><span class="token punctuation">(</span>index<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span><span class="token string">"depart_list.html"</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span><span class="token string">'depart_list'</span><span class="token punctuation">:</span>pages<span class="token punctuation">,</span><span class="token string">"start_index"</span><span class="token punctuation">:</span>startindex<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">depart_add</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">"POST"</span><span class="token punctuation">:</span>
        depaer_ment<span class="token operator">=</span>request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"depart_name"</span><span class="token punctuation">)</span>
        depart_query <span class="token operator">=</span> Department<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>title<span class="token operator">=</span>depaer_ment<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> depart_query<span class="token punctuation">:</span>
            Department<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>create<span class="token punctuation">(</span>title<span class="token operator">=</span>depaer_ment<span class="token punctuation">)</span>
    <span class="token comment"># time.sleep(2)</span>
    <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">"/depart/list/"</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">depart_delete</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>path<span class="token punctuation">)</span>
    nid <span class="token operator">=</span> request<span class="token punctuation">.</span>GET<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"nid"</span><span class="token punctuation">)</span>
    Department<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span>nid<span class="token punctuation">)</span><span class="token punctuation">.</span>delete<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">"/depart/list/"</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">depart_edit</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span><span class="token string">"POST"</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>POST<span class="token punctuation">)</span>
        odepart <span class="token operator">=</span> request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"old_depart_name"</span><span class="token punctuation">)</span>
        ndepart <span class="token operator">=</span> request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"depart_name"</span><span class="token punctuation">)</span>
        Department<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>title<span class="token operator">=</span>odepart<span class="token punctuation">)</span><span class="token punctuation">.</span>update<span class="token punctuation">(</span>title<span class="token operator">=</span>ndepart<span class="token punctuation">)</span>

    <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">"/depart/list/"</span><span class="token punctuation">)</span>

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure></li>
</ul>
<h5 id="7-5-2模板继承"><a href="#7-5-2模板继承" class="headerlink" title="7.5.2模板继承"></a>7.5.2模板继承</h5><figure><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>!定义模板</span><span class="token punctuation">></span></span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
    &#123;% block css %&#125; #css模板
        
    &#123;%endblock%&#125;
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>
        &#123;% block content %&#125;
        
        &#123;%endblock%&#125;
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>
    &#123;% block js %&#125; #js模板
        
    &#123;%endblock%&#125;
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<p>​		继承模板</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup">&#123;%extneds 'layout.html'%&#125;

&#123;% block css %&#125;  自己的css&#123;%endblock%&#125;
&#123;% block content %&#125;

&#123;%endblock%&#125;
&#123;% block js %&#125;  自己的js&#123;%endblock%&#125;
<span class="token comment">&lt;!--继承或者自己重载相关--></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<ul>
<li>~~~python<br>deaprt &#x3D; models.ForeignKey(to&#x3D;”Department”, to_field&#x3D;”id”, on_delete&#x3D;models.CASCADE,null&#x3D;True)<br>#depart 为两表关键外键<br>title &#x3D; depart.object.filter(depart).title #获取关联表的属性<br>depart.object.filter(depart) #会直接帮你关联到另外一张表的对象<br>#django为我们封装好了 <figure><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">
##### 7.5.3 django 组件

###### 	7.5.3.1django组件

1. form组件
2. modelform组件

###### 	7.5.3.2 form组件

~~~python
class myform(django.form):
    user &#x3D; form.charField(weight&#x3D;form.input)
    
def depart_edit(request):
    form &#x3D; myform() #实例化自己的表单对象
    return render(requests,&quot;&#x2F;depart&#x2F;list&#x2F;&quot;,&#123;&quot;form&quot;:form&#125;)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure></li>
</ul>
<p>前端</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span><span class="token punctuation">></span></span>
    &#123;% for i in form %&#125;
    	&#123;i&#125; 或者 &#123;i.user&#125;
    &#123;endfor&#125;i
    
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<p>$\color{red}{form组件会操成与model大量重复代码 不推荐使用}$</p>
<h6 id="7-5-3-3-modelform组件"><a href="#7-5-3-3-modelform组件" class="headerlink" title="7.5.3.3   modelform组件"></a>7.5.3.3   <em>modelform</em>组件</h6><figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#前端用法与form组件相同</span>
<span class="token keyword">from</span> django<span class="token punctuation">.</span>forms <span class="token keyword">import</span> widgets <span class="token keyword">as</span> wid  <span class="token comment">#因为重名，所以起个别名</span>
        widgets <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
            <span class="token string">"name"</span><span class="token punctuation">:</span>wid<span class="token punctuation">.</span>TextInput<span class="token punctuation">(</span>attrs<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">'class'</span><span class="token punctuation">:</span><span class="token string">'form-control'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string">"age"</span><span class="token punctuation">:</span>wid<span class="token punctuation">.</span>NumberInput<span class="token punctuation">(</span>attrs<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">'class'</span><span class="token punctuation">:</span><span class="token string">'form-control'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string">"email"</span><span class="token punctuation">:</span>wid<span class="token punctuation">.</span>EmailInput<span class="token punctuation">(</span>attrs<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">'class'</span><span class="token punctuation">:</span><span class="token string">'form-control'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span>
  <span class="token comment">#简洁写法</span>
<span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span><span class="token operator">*</span>args<span class="token punctuation">,</span><span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span>__init<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span><span class="token operator">**</span>kwargs<span class="token punctuation">)</span>
    <span class="token keyword">for</span> name<span class="token punctuation">,</span>field <span class="token keyword">in</span> self<span class="token punctuation">.</span>fields<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        field<span class="token punctuation">.</span>wid<span class="token punctuation">.</span>attrs <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">'class'</span><span class="token punctuation">:</span><span class="token string">'form-control'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
 <span class="token comment">#添加样式</span>
<span class="token keyword">class</span> <span class="token class-name">userform</span><span class="token punctuation">(</span>ModelForm<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> UserInfo
        fields <span class="token operator">=</span><span class="token string">"__all__"</span>
        exclude <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"password"</span><span class="token punctuation">]</span> 

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>
        <span class="token keyword">for</span> name<span class="token punctuation">,</span> field <span class="token keyword">in</span> self<span class="token punctuation">.</span>fields<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            field<span class="token punctuation">.</span>widget<span class="token punctuation">.</span>attrs <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"class"</span><span class="token punctuation">:</span><span class="token string">"form-control"</span><span class="token punctuation">&#125;</span>
<span class="token keyword">def</span> <span class="token function">depart_list</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">'GET'</span><span class="token punctuation">:</span>
        student_list <span class="token operator">=</span> userform<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span><span class="token string">'student.html'</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span><span class="token string">'student_list'</span><span class="token punctuation">:</span>student_list<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        student_list <span class="token operator">=</span> StudentList<span class="token punctuation">(</span>request<span class="token punctuation">.</span>POST<span class="token punctuation">)</span>
        <span class="token keyword">if</span> student_list<span class="token punctuation">.</span>is_valid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            student_list<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> redirect<span class="token punctuation">(</span>request<span class="token punctuation">,</span><span class="token string">'student_list.html'</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span><span class="token string">'student_list'</span><span class="token punctuation">:</span>student_list<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
  <span class="token comment">#保存数据的时候，不用挨个取数据了，只需要save一下。</span>
<span class="token comment">#在视图函数当中的 使用</span>
<span class="token keyword">def</span> <span class="token function">user_add</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">"POST"</span><span class="token punctuation">:</span>
        myform <span class="token operator">=</span> userform<span class="token punctuation">(</span>data<span class="token operator">=</span>request<span class="token punctuation">.</span>POST<span class="token punctuation">)</span>
        <span class="token keyword">if</span> myform<span class="token punctuation">.</span>is_valid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            myform<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> JsonResponse<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">"msg"</span><span class="token punctuation">:</span><span class="token string">"处理完成"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>myform<span class="token punctuation">.</span>errors<span class="token punctuation">)</span>
            <span class="token keyword">return</span> JsonResponse<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">"msg"</span><span class="token punctuation">:</span><span class="token string">"处理失败 "</span><span class="token punctuation">,</span><span class="token string">"error_message"</span><span class="token punctuation">:</span>myform<span class="token punctuation">.</span>errors<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
        <span class="token comment">#直接存储数据 或者修改数据 </span>
        myform <span class="token operator">=</span> userform<span class="token punctuation">(</span>data<span class="token operator">=</span>request<span class="token punctuation">.</span>POST<span class="token punctuation">,</span> instance<span class="token operator">=</span>user_info<span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        myform<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<figure><div class="code-wrapper"><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span><span class="token punctuation">></span></span>
    &#123;% for i in form %&#125;
    	&#123;&#123;i&#125;&#125; 或者 &#123;&#123;i.user&#125;&#125;
    	&#123;&#123;i.label&#125;&#125; 显示数据库里面的verbose_name
    &#123;endfor&#125;i
    
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h5 id="7-6-用户登录验证"><a href="#7-6-用户登录验证" class="headerlink" title="7.6. 用户登录验证"></a>7.6. 用户登录验证</h5><figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#正则校验手机号码</span>
<span class="token keyword">from</span> django<span class="token punctuation">.</span>core<span class="token punctuation">.</span>validators <span class="token keyword">import</span> RegexValidator
<span class="token keyword">class</span> <span class="token class-name">myfrom</span><span class="token punctuation">(</span>modelform<span class="token punctuation">)</span><span class="token punctuation">:</span>
    xx<span class="token operator">=</span> form<span class="token punctuation">.</span>chidel<span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span> <span class="token comment"># 定义model没有的字段</span>
    moible <span class="token operator">=</span> forms<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>label <span class="token operator">=</span> <span class="token string">"手机号码"</span>，validators<span class="token operator">=</span><span class="token punctuation">[</span>RegexValidator<span class="token punctuation">(</span><span class="token string">r"^159[0-9]+$"</span><span class="token punctuation">,</span><span class="token string">'号码必须以159开头 '</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">"""    
	1.字段规则校验，字符长度，是否必填等基本校验
    2.validators校验（RegexValidator校验器或自定义校验函数）
    3.局部钩子（类中定义的以clean_字段名命名的函数，校验正常必须返回该字段的值self.cleaned_data.get(‘name’)）
    4.全局钩子（类中定义的函数名clean，校验正常必须返回该对象的校验结果值return self.cleaned_data）
    5.每一步通过校验单结果都以字典形式保存在类对象的cleaned_data属性中
"""</span>
      <span class="token keyword">def</span> <span class="token function">clean_city</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment"># 局部钩子定义在modelform初始化的时候</span>
        <span class="token triple-quoted-string string">"""局部钩子判断城市必须是北京/上海/深圳其中一个"""</span>
        city_val <span class="token operator">=</span> self<span class="token punctuation">.</span>cleaned_data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'city'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> city_val <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token string">"北京"</span><span class="token punctuation">,</span> <span class="token string">"上海"</span><span class="token punctuation">,</span> <span class="token string">"深圳"</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> city_val
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">raise</span> forms<span class="token punctuation">.</span>ValidationError<span class="token punctuation">(</span><span class="token string">'城市只能选:北京/上海/深圳'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#分页操作 </span>
<span class="token keyword">from</span> django<span class="token punctuation">.</span>core<span class="token punctuation">.</span>paginator <span class="token keyword">import</span> Paginator <span class="token comment">#导入分页类</span>
    query_set <span class="token operator">=</span> Department<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    paginator <span class="token operator">=</span> Paginator<span class="token punctuation">(</span>query_set<span class="token punctuation">,</span> page_size<span class="token punctuation">)</span> <span class="token comment">#query_set model对象，page_size 每页数量</span>
    pages <span class="token operator">=</span> paginator<span class="token punctuation">.</span>page<span class="token punctuation">(</span>index<span class="token punctuation">)</span> <span class="token comment"># index 代表 pages是显示第几页</span>
    
<span class="token comment">#json 格式化model对象</span>
<span class="token keyword">from</span> django<span class="token punctuation">.</span>core <span class="token keyword">import</span> serializers
<span class="token keyword">from</span> django<span class="token punctuation">.</span>http <span class="token keyword">import</span> JsonResponse <span class="token comment"># </span>
	user_info <span class="token operator">=</span> UserInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span>request<span class="token punctuation">.</span>GET<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token string">"字段"</span><span class="token punctuation">)</span>
    user_info <span class="token operator">=</span> UserInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span>request<span class="token punctuation">.</span>GET<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    user_json <span class="token operator">=</span> serializers<span class="token punctuation">.</span>serialize<span class="token punctuation">(</span><span class="token string">"json"</span><span class="token punctuation">,</span>user_info<span class="token punctuation">)</span>
      		
        <span class="token comment">#会将查询到的modesl对象转换成json</span>
        <span class="token keyword">return</span> JsonResponse<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">"msg"</span><span class="token punctuation">:</span><span class="token string">"处理完成"</span><span class="token punctuation">,</span><span class="token string">"user_info"</span><span class="token punctuation">:</span>user_json<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token comment">#这边也可以不用serializers方法 用first()可以直接放进json中</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h6 id="cookie和session-设置"><a href="#cookie和session-设置" class="headerlink" title="cookie和session 设置"></a>cookie和session 设置</h6><ol>
<li>使用Django框架自带的”request.user.is_authenticated()”方法来判断用户是否登录</li>
</ol>
<figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">if</span> request<span class="token punctuation">.</span>user<span class="token punctuation">.</span>is_authenticated<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token comment"># 如果登录返回用户想去的页面</span>
	<span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">"用户想去页面"</span><span class="token punctuation">)</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
	<span class="token comment"># 未登录, 重定向到用户登录页面</span>
	<span class="token keyword">return</span> redirect<span class="token punctuation">(</span>reverse<span class="token punctuation">(</span><span class="token string">"登录页面"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<ol start="2">
<li>使用Django自带的login_required装饰器(内部就是封装了is_authenticated())判断用户是否登录</li>
</ol>
<figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#1.需要在Django的settings配置文件中添加如果验证登录未通过需要跳转的路径</span>
<span class="token keyword">from</span> django<span class="token punctuation">.</span>contrib<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>decorators <span class="token keyword">import</span> login_required
<span class="token decorator annotation punctuation">@login_required</span>
LOGIN_URL <span class="token operator">=</span> <span class="token string">"/login/"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<p>cookie 和session设置</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python">request<span class="token punctuation">.</span>session<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">""</span> <span class="token comment">#相当于是字典操作</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></figure>

<p>前端ajax如何绕过ajdngo  csrf认证</p>
<ol>
<li><p>读取浏览器cookie当中的csrf字段</p>
</li>
<li><p>忽略部分view 的csrf</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> django<span class="token punctuation">.</span>views<span class="token punctuation">.</span>decorators<span class="token punctuation">.</span>csrf <span class="token keyword">import</span> csrf_exempt
<span class="token decorator annotation punctuation">@csrf_exempt</span>
<span class="token keyword">def</span> <span class="token function">task</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span>
<span class="token comment">#被装饰的函数将不会进行csrf认证</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div></figure></li>
</ol>
<h2 id="8-Django路由与视图详解"><a href="#8-Django路由与视图详解" class="headerlink" title="8. Django路由与视图详解"></a>8. <em>Django</em>路由与视图详解</h2><h3 id="8-1-path-与-re-path-路由函数"><a href="#8-1-path-与-re-path-路由函数" class="headerlink" title="8.1 path 与 re_path 路由函数"></a>8.1 path 与 re_path 路由函数</h3><p>re_path函数对比path，可以实现更加复杂的正则表达式路由规则</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python">path（<span class="token string">'app2/&lt;uuid:id>'</span><span class="token punctuation">,</span>view<span class="token punctuation">.</span>show_uuid<span class="token punctuation">,</span>name<span class="token operator">=</span><span class="token string">"show_uuid"</span>）
<span class="token triple-quoted-string string">"""
path 正则参数
 str : 任意非空字符，不包含“/”,默认类型
 int : 匹配0和任意整数
 slug ：匹配任意ASCⅡ字符、连接线和下划线
 uuid ： 匹配一个uuid格式的字符串，该对象必须包含“-”，所有字母必须小写。比如22221111-abcd-3cww-3321-123456789123
"""</span>

re_path<span class="token punctuation">(</span><span class="token string">'app2/list/(?&lt;year>\d&#123;4&#125;)/'</span><span class="token punctuation">,</span>view<span class="token punctuation">.</span>article<span class="token punctuation">.</span><span class="token builtin">list</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">"""
所用规则与正则表达式无差别
"""</span>
此上两种方法关键参数都是在<span class="token operator">&lt;></span>中
path<span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token builtin">type</span><span class="token punctuation">:</span><span class="token builtin">type</span><span class="token operator">></span><span class="token punctuation">)</span>
re_path<span class="token punctuation">(</span><span class="token string">'(?&lt;name>\d&#123;4&#125;)'</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h3 id="8-2-反向路由解析器"><a href="#8-2-反向路由解析器" class="headerlink" title="8.2 反向路由解析器"></a>8.2 反向路由解析器</h3><figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python">path（<span class="token string">'app2/&lt;uuid:id>'</span><span class="token punctuation">,</span>view<span class="token punctuation">.</span>show_uuid<span class="token punctuation">,</span>name<span class="token operator">=</span><span class="token string">"show_uuid"</span>）<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></figure>

<p>name可以在HTML中使用，根据name得到url地址。好处是name不变，url可以随意修改。</p>
<p>reverse() 方法 可以根据name 反向解析出这个name代表的URL</p>
<h3 id="8-3-视图函数的底层处理"><a href="#8-3-视图函数的底层处理" class="headerlink" title="8.3 视图函数的底层处理"></a>8.3 视图函数的底层处理</h3><ol>
<li><p>HttpRequest 和 HttpResponse 对象</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># HttpRequest对象</span>
path  字符串，便是请求页面的路径，不包含域名
method 字符串，表示页面请求的方式。必须以大写方式
encoding 字符串，表示提交的数据的编码方式
GET 字典类型，包含GET请求方法中的所有参数
POSt 字典类型，包含POSt请求方法中的所有参数
FILE 字典类型，包含上传文件的信息
COOKIES 字典类型，包含所有的cookie对象
session 字典类型，表示当前会话
META 字典类型，包含所有的HTTP头部信息，如HTTP_USER_AGENT、REMOTE_ADDR
user 表示当前登录用户
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>
</li>
<li><p>HttpResposne </p>
<figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token triple-quoted-string string">"""
常见参数
content 返回的内容
status_code 返回的HTTP响应状态吗
content-type 返回的数据的MIME类型，默认为text/html
"""</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure></li>
</ol>
<h3 id="8-4-视图处理函数的使用"><a href="#8-4-视图处理函数的使用" class="headerlink" title="8.4 视图处理函数的使用"></a>8.4 视图处理函数的使用</h3><ol>
<li><p>render()函数</p>
   <figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> django<span class="token punctuation">.</span>shortcts <span class="token keyword">import</span> render
render<span class="token punctuation">(</span>request<span class="token punctuation">,</span>template_name<span class="token punctuation">,</span>content<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>content_type<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>status<span class="token operator">=</span><span class="token boolean">None</span>，using<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">"""
content: 字典类型，保存要传到html的变量
status: 表示响应的状态代码，默认为200
content_type: 用于生成文档的MIME类型，默认为text/html
using：设置末班引擎，用于解析模板文件
"""</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>
</li>
<li><p>redict()函数<br>重定向的三种方式</p>
<ol>
<li><p>通过调用模板的get_absolute_url()函数</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">UserInfo</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    name<span class="token operator">=</span>models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">)</span>                        <span class="token comment"># primary_key = True</span>
    password <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">)</span>                    <span class="token comment"># 修改表的时候，可以直接添加一行或去掉。 </span>
    age <span class="token operator">=</span> models<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>default<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>  
    <span class="token keyword">def</span> <span class="token function">get_absolute_url</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> reverse<span class="token punctuation">(</span><span class="token string">"url"</span><span class="token punctuation">,</span>kwargs<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">'id'</span><span class="token punctuation">:</span><span class="token string">"self.id"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>


</li>
<li><p>通过路由反向解析进行重定向</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">test_redict_view</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span><span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">"url"</span><span class="token punctuation">,</span><span class="token builtin">id</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div></figure>
</li>
<li><p>通过绝对的或者相对的url进行重定向</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">"https://"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></figure></li>
</ol>
</li>
</ol>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/python/" class="category-chain-item">python</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/DJANGO/">#DJANGO</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>Django学习笔记</div>
      <div>https://mrthere3.github.io/2022/10/29/DJANGO 学习/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>Wang sanmeng</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2022年10月29日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2022/10/29/VUE%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/" title="Vue学习笔记">
                        <span class="hidden-mobile">Vue学习笔记</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  <article id="comments" lazyload>
    
  <div id="valine"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#valine', function() {
      Fluid.utils.createScript('https://lib.baomitu.com/valine/1.5.1/Valine.min.js', function() {
        var options = Object.assign(
          {"appId":"Yu9cn7racZ6TkMkaFStimJ3X-gzGzoHsz","appKey":"HtlIrsYx5LBHSordjrE6iqEe","path":"window.location.pathname","placeholder":"昵称支持qq号自动获取，评论头像采用QQ头像","avatar":"monsterid","meta":["nick","mail"],"requiredFields":["nick"],"pageSize":10,"lang":"zh-CN","highlight":false,"recordIP":false,"serverURLs":"","emojiCDN":null,"emojiMaps":null,"enableQQ":true},
          {
            el: "#valine",
            path: window.location.pathname
          }
        )
        new Valine(options);
        Fluid.utils.waitElementVisible('#valine .vcontent', () => {
          var imgSelector = '#valine .vcontent img:not(.vemoji)';
          Fluid.plugins.imageCaption(imgSelector);
          Fluid.plugins.fancyBox(imgSelector);
        })
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


  </article>


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://github.com/mrthere3?tab=repositories" target="_blank" rel="nofollow noopener"><span>laowang</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/mrthere3/leetcode-master" target="_blank" rel="nofollow noopener"><span>lovecode</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script  src="https://lib.baomitu.com/prism/1.28.0/plugins/line-numbers/prism-line-numbers.min.js" ></script>

  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
<script type="text/javascript">
        //只在桌面版网页启用特效
        var windowWidth = $(window).width();
        if (windowWidth > 768) {
            document.write('<script type="text/javascript" src="/js/sakura.js"><\/script>');
        }
        </script>
</html>
</html>

